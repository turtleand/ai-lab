---
title: "Notificaciones del agente"
module: "Module 0: Setup & Safety"
subtopic: "agent-notifications"
summary: "Recibe notificaciones cuando tu agente termina usando hooks y ntfy."
status: "done"
---

## El problema

Cuando trabajas con agentes de IA en tareas largas, tienes dos opciones:

1. **Esperar mirando** — quedarte viendo la pantalla hasta que termine
2. **Hacer otra cosa** — pero luego olvidarte de volver a revisar

Ninguna es ideal. ¿Y si el agente pudiera enviarte una notificación cuando termine?

---

## La solución

Combinamos dos cosas:

- **Hooks** — acciones automáticas que se ejecutan cuando ocurren ciertos eventos en Claude Code
- **ntfy** — un servicio gratuito que envía notificaciones a tu teléfono o computadora

Cuando Claude termina una tarea, un hook se activa y te envía una notificación push.

---

## Por qué es confiable

Algo importante: **las notificaciones son 100% confiables**.

Los agentes de IA son impredecibles en *lo que* producen. Pero el sistema de notificaciones corre por separado de la IA. Se activa por la aplicación misma, no por las decisiones de Claude.

Piénsalo como un temporizador de horno. El horno no decide cuándo sonar — el temporizador lo hace, automáticamente, cuando se acaba el tiempo.

---

## ¿Qué es ntfy?

[ntfy](https://ntfy.sh) (se pronuncia "notify") es un servicio simple de notificaciones push. Te suscribes a un "topic" (como un canal privado), y cualquier cosa enviada a ese topic aparece como notificación en tus dispositivos.

**Cómo funciona:**
1. Eliges un nombre de topic (usa una cadena aleatoria para privacidad)
2. Te suscribes desde tu teléfono o computadora
3. Cualquier mensaje enviado a ese topic se convierte en notificación

Es gratis, open source, y no requiere cuenta. Ver la [documentación de ntfy](https://docs.ntfy.sh/) para más detalles.

---

## ¿Qué son los hooks?

Los hooks son comandos que Claude Code ejecuta automáticamente en momentos específicos:

- **Cuando envías un mensaje** — la app puede ejecutar un comando
- **Cuando Claude termina** — la app puede ejecutar otro comando

Usamos esto para:
1. Guardar lo que pediste (cuando envías un mensaje)
2. Enviar una notificación con esa info (cuando Claude termina)

Para la referencia técnica completa, ver la [documentación de hooks de Claude Code](https://docs.anthropic.com/en/docs/claude-code/hooks).

---

## Configuración

### 1. Instala ntfy en tu teléfono

Descarga la app:
- [iOS App Store](https://apps.apple.com/app/ntfy/id1625396347)
- [Android Play Store](https://play.google.com/store/apps/details?id=io.heckel.ntfy)

Suscríbete a un topic con un nombre aleatorio (ej., `mi-topic-secreto-abc123`). Mantén este nombre privado.

### 2. Crea el script de notificación

Crea una carpeta y archivo para el hook:

```bash
mkdir -p ~/.claude/hooks
```

Crea el archivo `~/.claude/hooks/notify-stop.sh` con este contenido:

```bash
#!/bin/bash
INPUT=$(cat)
STOP_ACTIVE=$(echo "$INPUT" | jq -r '.stop_hook_active')
[ "$STOP_ACTIVE" = "true" ] && exit 0

TASK=$(cat /tmp/claude_last_task.txt 2>/dev/null || echo "tarea")
CWD=$(echo "$INPUT" | jq -r '.cwd')
PROJECT=$(basename "$CWD")

curl -s -d "[$PROJECT] Listo: $TASK" https://ntfy.sh/TU_TOPIC_AQUI
exit 0
```

Reemplaza `TU_TOPIC_AQUI` con el nombre de tu topic.

Hazlo ejecutable:

```bash
chmod +x ~/.claude/hooks/notify-stop.sh
```

### 3. Configura Claude Code

Edita `~/.claude/settings.json`:

```json
{
  "hooks": {
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "jq -r '.prompt' | head -c 100 > /tmp/claude_last_task.txt"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/notify-stop.sh"
          }
        ]
      }
    ]
  }
}
```

### 4. Reinicia Claude Code

Cierra y vuelve a abrir Claude Code. Los hooks se cargan al inicio.

---

## Cómo lo uso

1. **Inicio una tarea** — le pido a Claude que haga algo
2. **Cambio a otro trabajo** — no necesito estar mirando
3. **Recibo notificación** — el teléfono vibra con `[proyecto] Listo: tu tarea...`
4. **Vuelvo** — la notificación me recuerda qué pedí

Funciona bien para:
- Tareas largas (refactorización, debugging)
- Ejecutar múltiples sesiones de Claude
- Trabajar lejos de la computadora

---

## Solución de problemas

| Problema | Causa probable | Solución |
|----------|----------------|----------|
| Sin notificación | Problema de red | Verificar conexión a internet |
| Mensaje vacío | Herramienta faltante | Instalar `jq` (`brew install jq`) |
| Error en script | Permisos | Ejecutar `chmod +x` en el script |
| No pasa nada | Settings no cargados | Reiniciar Claude Code |

---

## Fuentes

- [Documentación de ntfy](https://docs.ntfy.sh/) — guía completa del servicio de notificaciones
- [Hooks de Claude Code](https://docs.anthropic.com/en/docs/claude-code/hooks) — referencia oficial para configuración de hooks
